mOxie.Mime.addMimeType("video/quicktime, mov");var xoctFileuploader={init:function(){mOxie.Mime.addMimeType("video/quicktime, mov");var a=new plupload.Uploader({cmd:"",runtimes:xoctFileuploaderSettings.runtimes,browse_button:xoctFileuploaderSettings.pick_button,url:xoctFileuploaderSettings.getUrl(),chunk_size:xoctFileuploaderSettings.chunk_size,unique_names:false,has_files:false,filters:{max_file_size:xoctFileuploaderSettings.max_file_size},multi_selection:false,flash_swf_url:"../js/Moxie.swf",silverlight_xap_url:"../js/Moxie.xap",preinit:{Init:function(b,d){var c=this;d.runtime=="html5"?xoctWaiter.init("percentage"):xoctWaiter.init();$(document).ready(function(){$('#form_xoct_event input[name="cmd[create]"]').click(function(f){f.preventDefault();c.cmd=$(this).attr("name");if(c.has_files){xoctWaiter.show();c.start()}else{alert(xoctFileuploaderSettings.lng.msg_select)}return false});$("#xoct_clear").click(function(){c.splice()});$("#xoct_clear").hide()})}},init:{UploadComplete:function(b,d){var c={target_name:"",name:"",size:""};xoctWaiter.reinit("waiter");xoctWaiter.show();plupload.each(d,function(e){c=e});console.log(c);$("#postvar_temp_file").val(c.target_name);$("#postvar_file_name").val(c.name);$("#postvar_size").val(c.size);$("#xoct_cmd").attr("name",this.cmd);$("#xoct_cmd").val(1);setTimeout(function(){$("#form_"+xoctFileuploaderSettings.form_id).submit()},300)},FilesAdded:function(b,e){function d(j,h){var g=h.length;for(var f=0;f<g;f++){if(h[f]==j){return true}}return false}var c=this;plupload.each(e,function(f){console.log(f);if(!d(f.type,xoctFileuploaderSettings.mime_types_array)&&!f.type.startsWith("video/")){alert(xoctFileuploaderSettings.lng.msg_not_supported)}else{c.has_files=true;$("#pickfiles").hide();$("#xoct_clear").show();$("#xoct_progress").show();$("#xoct_file").html(f.name)}})},FilesRemoved:function(b,c){plupload.each(c,function(d){});$("#xoct_file").html("&nbsp;");$("#xoct_clear").hide();this.has_files=false},UploadProgress:function(b,c){var d=c.percent;xoctWaiter.setPercentage(d)}}});a.init()}};var xoctFileuploaderSettings={initFromJSON:function(c){var b=this;var a=JSON.parse(c);for(var d in a){b[d]=a[d]}xoctFileuploader.init()},getUrl:function(){var a=new RegExp("amp;","g");console.log(this);return this.url.replace(a,"")}};